---
allowed-tools: Bash(git add:*), Bash(git status:*), Bash(git commit:*), Bash(git diff:*), Bash(gdate:*)
description: Create a git commit following team's version control guidelines
---

## Context

- Session ID: !`gdate +%s%N`
- Current git status: !`git status`
- Current git diff (staged and unstaged changes): !`git diff HEAD`
- Current branch: !`git branch --show-current`
- Recent commits: !`git log --oneline -10`

## Your task

Generate a conventional commit message following the team's version control guidelines and create the commit automatically.

STEP 1: Analyze current git state and changes

- EXAMINE output from Context section for current status
- DETERMINE if there are staged changes ready for commit
- IF no staged changes found:
  - IDENTIFY unstaged changes that should be committed
  - STAGE appropriate files using `git add`
- VALIDATE that commit is appropriate (not empty, not work-in-progress)

STEP 2: Analyze AI contribution ratio

- EXAMINE the git diff output to determine code contribution sources
- CALCULATE contribution percentages using these categories:
  - **AI Generated**: Code written entirely by AI without manual modification
  - **AI Assisted**: Code generated by AI but modified/refined by user
  - **User Written**: Code written entirely by user without AI assistance
  - **Mixed**: Combination of AI and user contributions in same file/section

- USE formula: `(AI Lines + (AI Assisted Lines Ã— 0.7)) / Total Modified Lines Ã— 100`
- DETERMINE if AI co-author attribution is needed (>70% AI contribution)

STEP 3: Determine conventional commit type and scope

- ANALYZE the nature of changes from git diff output
- CATEGORIZE changes using conventional commit types:
  - `feat`: New feature
  - `fix`: Bug fix
  - `refactor`: Code refactoring (no functional changes)
  - `style`: Formatting changes (no code changes)
  - `docs`: Documentation updates
  - `test`: Add or refactor tests
  - `chore`: Build process, dependencies, or tooling changes

- IDENTIFY scope if applicable (component, module, or functional area affected)

STEP 4: Compose conventional commit message

### Subject Line (max 50 characters)
- Format: `<type>: <subject>` or `<type>(<scope>): <subject>`
- Capitalize first letter after type
- Use imperative mood ("add" not "added" or "adds")
- No period at the end

### Body (REQUIRED - MANDATORY)
- **MUST include body for ALL commits**
- Maximum 72 characters per line
- Separate from subject with blank line
- **Intent focused**: Explain WHY the change was made, not just WHAT changed
- **Context aware**: Include background and purpose of the change
- **Collaboration oriented**: Reflect requirements and problem awareness
- Use "-" for bullet points when listing multiple reasons
- Minimum content requirements:
  - At least explain the motivation for the change
  - Include "This change was needed because:" or similar context
  - For simple changes, at least one sentence explaining why

### AI Contribution Section (REQUIRED if AI contribution >30%)
Include in body after the main explanation:
```
Code Contribution:
- AI Generated: XX%
- AI Assisted: XX%
- User Written: XX%
```

For significant AI contributions (>70%), also add:
- Tool identification (e.g., Claude Code)
- Modification summary (what was changed from AI output)
- Quality assurance notes (testing performed)

### Footer (optional but recommended)
- Reference related issues, PRs, or tickets (e.g., `Fixes #142`, `Related to INF-24`)
- If >70% AI contribution, add:
  - `ðŸ¤– Generated with [Claude Code](https://claude.ai/code)`
  - `Co-Authored-By: Claude <noreply@anthropic.com>`

STEP 5: Create the commit

TRY:
- EXECUTE `git commit` with generated message
- USE heredoc or -m flag for multi-line messages to ensure proper formatting
- ENSURE proper line breaks between subject, body, and footer
- VERIFY body is included (reject commits without body)

CATCH (commit_failed):
- ANALYZE error message
- PROVIDE guidance on resolution
- SUGGEST alternative approaches

STEP 6: Validate commit result

- CONFIRM commit was created successfully
- VERIFY body was included in the commit message
- DISPLAY commit hash and message
- PROVIDE summary of what was committed
- REMIND about push if needed

## Example commit messages

### Simple change (no AI involvement):
```
feat: add user authentication system

Implement JWT-based authentication to secure API endpoints.
This change was needed because:

- Previous system lacked proper security measures
- Users requested account protection features
- Compliance requirements for data protection

Fixes #142
```

### Small fix (body still required):
```
fix: correct typo in error message

Fix typo in authentication error message that was confusing users.
This change improves user experience by providing clear error feedback.

Related to #256
```

### With AI assistance:
```
refactor: simplify database connection logic

Extract connection pooling into separate module to improve
code maintainability and reduce duplication across services.

Code Contribution:
- AI Generated: 80%
- User Written: 20%

AI generated the core connection logic, user added error handling
and configuration management.

Related to INF-24

ðŸ¤– Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>
```

### Mixed contribution:
```
feat: implement user dashboard with real-time updates

Create comprehensive dashboard showing user activity, notifications,
and system status with WebSocket integration.

Code Contribution:
- AI Generated: 45%
- AI Assisted: 30%
- User Written: 25%

Claude Code generated component structure and WebSocket handlers.
User implemented custom styling, error boundaries, and performance
optimizations.

Closes #89

ðŸ¤– Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>
```

## Important Guidelines

1. **BODY IS MANDATORY** - Every commit MUST have a body explaining WHY
2. **Always explain WHY** in the body, not just what changed
3. **Track AI contributions** when applicable (>30% AI involvement)
4. **Use proper attribution** for significant AI contributions (>70%)
5. **Follow the 50/72 character limits** for subject/body
6. **Use imperative mood** and capitalize after type prefix
7. **Reference issues/tickets** in footer when applicable
8. **NO EMPTY BODIES** - Reject any commit without proper explanation

## Validation Checklist

Before creating commit, ensure:
- [ ] Subject line follows format and is under 50 characters
- [ ] Body is present and explains WHY the change was made
- [ ] Body lines are wrapped at 72 characters
- [ ] Blank line separates subject from body
- [ ] AI contribution is tracked if applicable
- [ ] Related issues/tickets are referenced if applicable
